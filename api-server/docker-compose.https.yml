version: '3.8'

services:
  api-server:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: pingmailer-api-server
    restart: unless-stopped
    
    # HTTPS mode
    ports:
      - "8443:8443"
    
    environment:
      - PORT=8443
      - CERT_FILE=/certs/fullchain.pem
      - KEY_FILE=/certs/privkey.pem
    
    # Mount certificates from mail-infra
    # Update 'yourdomain.com' with your actual domain
    volumes:
      - ../mail-infra/services/silver-config/certbot/keys/etc/live/yourdomain.com:/certs:ro
    
    # Join the mail network to integrate with mail services
    networks:
      - mail-network

networks:
  mail-network:
    external: true
